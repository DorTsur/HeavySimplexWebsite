---
layout: default
title: "HeavyWater & SimplexWater"
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }}</title>
  <style>
    body {
      max-width: 1200px;
      margin: 2rem auto;
    }
    #hero h1, #hero h1 code {
      font-size: 2.8rem;
    }
    #hero h1 span {
      font-size: 1.5rem;
    }
  </style>
</head>
<body>


  <!-- Hero Section -->
  <section id="hero" style="text-align: center;">
    <h1 style="font-size: 2.8rem;">
      <code>SimplexWater</code> and <code>HeavyWater</code>:<br>
      <span style="font-weight: normal; font-size: 2.1rem;">Watermarking Low-Entropy Text Distributions</span>
    </h1>
    <p class="authors" style="text-align: center;">
      <a href="https://sites.google.com/view/dortsur/home">Dor Tsur</a>,
      <a href="https://carol-long.github.io/">Carol Xuan Long</a>,
      <a href="https://claudioverdun.github.io/">Claudio M. Verdun</a>,
      <a href="https://scholar.google.com/citations?user=_hSfZbMAAAAJ&hl=en">Sajani Vithana</a>,
      <a href="https://www.ee.bgu.ac.il/~haimp/">Haim Permuter</a>,
      <a href="https://people.seas.harvard.edu/~flavio/">Flavio P. Calmon</a>
    </p>
    <div style="margin: 1rem 0;">
      <a href="/assets/paper/IT_Watermarking_LLM.pdf" target="_blank">arXiv</a>
      &nbsp;|&nbsp;
      <a href="https://github.com/DorTsur/HeavySimplexWebsite" target="_blank">Code</a>
    </div>
  </section>

  <!-- System Image before Abstract -->
  <img src="assets/images/system.png" alt="System Diagram" style="display:block; margin:2rem auto; max-width:700px;">

  <!-- Abstract -->
  <section id="abstract">
    <h2>Abstract</h2>
    <p>Large language model (LLM) watermarks enable authentication of text provenance, curb misuse of machine-generated text, and promote trust in AI systems. Current watermarks operate by changing the next-token predictions output by an LLM. The updated (i.e., watermarked) predictions depend on random side information produced, for example, by hashing previously generated tokens. LLM watermarking is particularly challenging in low-entropy generation tasks—such as coding—where next-token predictions are near-deterministic. In this paper, we propose an optimization framework for watermark design. Our goal is to understand how to most effectively use random side information in order to maximize the likelihood of watermark detection and minimize the distortion of generated text. Our analysis informs the design of two new watermarks: HeavyWater and SimplexWater. Both watermarks are tunable, gracefully trading-off between detection accuracy and text distortion. They can also be applied to any LLM and are agnostic to side information generation. We examine the performance of HeavyWater and SimplexWater through several benchmarks, demonstrating that they can achieve high watermark detection accuracy with minimal compromise of text generation quality, particularly in the low-entropy regime. Our theoretical analysis also reveals surprising new connections between LLM watermarking and coding theory.</p>
  </section>

  <!-- Simplex and Heavy Images Side by Side -->
  <div style="display: flex; justify-content: center; gap: 2rem; margin: 2rem 0;">
    <a href="#SimplexWater">
      <img src="assets/images/simplex.png" alt="SimplexWater" style="max-width:200px; border-radius:8px;">
    </a>
    <a href="#HeavyWater">
      <img src="assets/images/heavy.png" alt="HeavyWater" style="max-width:200px; border-radius:8px;">
    </a>
  </div>

  <!-- Methods -->
  <section id="methods">
    <h2>Methods</h2>
    <h3 id="SimplexWater"><code>SimplexWater</code></h3>
    <p>Brief description and intuition.</p>
    <h3 id="HeavyWater"><code>HeavyWater</code></h3>
    <p>Brief description and intuition.</p>
  </section>

  <!-- Results -->
  <section id="results">
    <h2>Results</h2>
    <p>Key detection-distortion tradeoff curves and tables.</p>
    <div style="text-align: center; margin: 2rem 0;">
      <div style="margin-bottom: 1.5rem;">
        <div style="margin-bottom: 0.5rem;">Caption for Improvement</div>
        <img src="assets/images/improvement.png" alt="Improvement" style="max-width: 300px; border-radius: 8px;">
      </div>
      <div style="margin-bottom: 1.5rem;">
        <div style="margin-bottom: 0.5rem;">Caption for Tradeoff</div>
        <img src="assets/images/tradeoff.png" alt="Tradeoff" style="max-width: 300px; border-radius: 8px;">
      </div>
      <div>
        <div style="margin-bottom: 0.5rem;">Caption for Watermark Size</div>
        <img src="assets/images/watermark_Size.png" alt="Watermark Size" style="max-width: 300px; border-radius: 8px;">
      </div>
    </div>
  </section>

  <!-- Gallery
  <section id="gallery">
    <h2>Gallery</h2>
    <div class="image-grid">
      <!-- Thumbnail images linking to full-size versions -->
    <!-- </div>
  </section> --> -->

  <!-- Resources -->
  <section id="resources">
    <h2>Resources</h2>
    <ul>
      <li><a href="https://github.com/DorTsur/HeavySimplexWebsite" target="_blank">Code &amp; Installation</a></li>
      <li><a href="#">Data &amp; Benchmarks</a></li>
      <li><a href="#">Supplementary Materials</a></li>
    </ul>
  </section>

  <!-- Contact -->
  <section id="contact">
    <h2>Contact</h2>
    <p>Dor Tsur, Harvard Kennedy School</p>
    <p><a href="mailto:dortsur@fas.harvard.edu">dortsur@fas.harvard.edu</a></p>
  </section>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 Dor Tsur. <a href="https://dortsur.github.io/HeavySimplexWebsite">https://dortsur.github.io/HeavySimplexWebsite</a></p>
  </footer>

</body>
</html>
